\hypertarget{maximal__repeats_8c}{\section{src/applications/maximal\-\_\-repeats.c \-File \-Reference}
\label{maximal__repeats_8c}\index{src/applications/maximal\-\_\-repeats.\-c@{src/applications/maximal\-\_\-repeats.\-c}}
}


\-Implementation of the functions related to maximal repeats.  


{\ttfamily \#include \char`\"{}maximal\-\_\-repeats.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}map\-\_\-bwt\-\_\-to\-\_\-s.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}mapper.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}../core/iterate.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}../../include/utils.\-h\char`\"{}}\*
{\ttfamily \#include $<$stdlib.\-h$>$}\*
{\ttfamily \#include $<$string.\-h$>$}\*
{\ttfamily \#include $<$stdio.\-h$>$}\*
\subsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structparameter__struct}{parameter\-\_\-struct} $\ast$ \hyperlink{maximal__repeats_8c_adfa4a6bccb21aa65557c85d4f208d50e}{initialize\-\_\-for\-\_\-max\-\_\-repeats} (char $\ast$string, int threshold)
\begin{DoxyCompactList}\small\item\em \-An initialization function that creates a parameter struct that instructs iterate to search for maximal repeats. \end{DoxyCompactList}\item 
int \hyperlink{maximal__repeats_8c_a3d279820c625ee97e1f906de9f8fa049}{is\-\_\-interval\-\_\-left\-\_\-maximal} (\hyperlink{structbit__vector}{bit\-\_\-vector} $\ast$runs, \hyperlink{structs_8h_structinterval}{interval} inter)
\begin{DoxyCompactList}\small\item\em \-A simple function for determining if an interval is right maximal. \end{DoxyCompactList}\item 
void \hyperlink{maximal__repeats_8c_ae885f154f5e25d7008341027edebe4ec}{search\-\_\-maximal\-\_\-repeats} (\hyperlink{iterate_8h_structiterator__state}{iterator\-\_\-state} $\ast$state, void $\ast$results)
\begin{DoxyCompactList}\small\item\em \-The function given as callback to iterate for finding maximal repeats. \end{DoxyCompactList}\item 
void \hyperlink{maximal__repeats_8c_a4da412d937a20364aa1a90bc974d287f}{print\-\_\-maximal\-\_\-repeat\-\_\-substrings} (char $\ast$string, \hyperlink{maximal__repeats_8h_structmax__repeat__results}{max\-\_\-repeat\-\_\-results} $\ast$results, \hyperlink{iterate_8h_structiterator__state}{iterator\-\_\-state} $\ast$state)
\begin{DoxyCompactList}\small\item\em \-Prints the substring the interval represents. \end{DoxyCompactList}\item 
\hyperlink{structbit__vector}{bit\-\_\-vector} $\ast$ \hyperlink{maximal__repeats_8c_a8c8842442c97f3872949c3d5cc7e4034}{max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector} (\hyperlink{maximal__repeats_8h_structmax__repeat__results}{max\-\_\-repeat\-\_\-results} $\ast$results, \hyperlink{iterate_8h_structiterator__state}{iterator\-\_\-state} $\ast$state)
\begin{DoxyCompactList}\small\item\em \-Creates a bit vectors based on the given string, where marked bits correspond to starting indexes of maximal repeats inside the string. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{\-Detailed \-Description}
\-Implementation of the functions related to maximal repeats. \begin{DoxyAuthor}{\-Author}
\-Lassi \-Vapaakallio, \-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000031}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\subsection{\-Function \-Documentation}
\hypertarget{maximal__repeats_8c_adfa4a6bccb21aa65557c85d4f208d50e}{\index{maximal\-\_\-repeats.\-c@{maximal\-\_\-repeats.\-c}!initialize\-\_\-for\-\_\-max\-\_\-repeats@{initialize\-\_\-for\-\_\-max\-\_\-repeats}}
\index{initialize\-\_\-for\-\_\-max\-\_\-repeats@{initialize\-\_\-for\-\_\-max\-\_\-repeats}!maximal_repeats.c@{maximal\-\_\-repeats.\-c}}
\subsubsection[{initialize\-\_\-for\-\_\-max\-\_\-repeats}]{\setlength{\rightskip}{0pt plus 5cm}{\bf parameter\-\_\-struct}$\ast$ {\bf initialize\-\_\-for\-\_\-max\-\_\-repeats} (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{string, }
\item[{int}]{threshold}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}read\mbox{]}}}}\label{maximal__repeats_8c_adfa4a6bccb21aa65557c85d4f208d50e}


\-An initialization function that creates a parameter struct that instructs iterate to search for maximal repeats. 


\begin{DoxyParams}{\-Parameters}
{\em string} & \-The string that should be iterated over. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-An initialized parameter struct ready to be passed to iterate. 
\end{DoxyReturn}
\begin{DoxySeeAlso}{\-See also}
iterate.\-h\-::parameter\-\_\-struct 
\end{DoxySeeAlso}
\begin{DoxyAuthor}{\-Author}
\-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000036}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\-References search\-\_\-maximal\-\_\-repeats().

\hypertarget{maximal__repeats_8c_a3d279820c625ee97e1f906de9f8fa049}{\index{maximal\-\_\-repeats.\-c@{maximal\-\_\-repeats.\-c}!is\-\_\-interval\-\_\-left\-\_\-maximal@{is\-\_\-interval\-\_\-left\-\_\-maximal}}
\index{is\-\_\-interval\-\_\-left\-\_\-maximal@{is\-\_\-interval\-\_\-left\-\_\-maximal}!maximal_repeats.c@{maximal\-\_\-repeats.\-c}}
\subsubsection[{is\-\_\-interval\-\_\-left\-\_\-maximal}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf is\-\_\-interval\-\_\-left\-\_\-maximal} (
\begin{DoxyParamCaption}
\item[{{\bf bit\-\_\-vector} $\ast$}]{runs, }
\item[{{\bf interval}}]{inter}
\end{DoxyParamCaption}
)}}\label{maximal__repeats_8c_a3d279820c625ee97e1f906de9f8fa049}


\-A simple function for determining if an interval is right maximal. 


\begin{DoxyParams}{\-Parameters}
{\em runs} & \-The runs vector for the \-B\-W\-T of a string. \\
\hline
{\em inter} & \-The interval to be checked. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
{\ttfamily 1} if the interval is a maximal repeat, {\ttfamily 0} otherwise. 
\end{DoxyReturn}
\begin{DoxyAuthor}{\-Author}
\-Lassi \-Vapaakallio, \-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000032}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\-References bit\-\_\-vector\-::rank.



\-Referenced by search\-\_\-maximal\-\_\-repeats().

\hypertarget{maximal__repeats_8c_a8c8842442c97f3872949c3d5cc7e4034}{\index{maximal\-\_\-repeats.\-c@{maximal\-\_\-repeats.\-c}!max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector@{max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector}}
\index{max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector@{max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector}!maximal_repeats.c@{maximal\-\_\-repeats.\-c}}
\subsubsection[{max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bit\-\_\-vector}$\ast$ {\bf max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector} (
\begin{DoxyParamCaption}
\item[{{\bf max\-\_\-repeat\-\_\-results} $\ast$}]{results, }
\item[{struct {\bf iterator\-\_\-state} $\ast$}]{state}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}read\mbox{]}}}}\label{maximal__repeats_8c_a8c8842442c97f3872949c3d5cc7e4034}


\-Creates a bit vectors based on the given string, where marked bits correspond to starting indexes of maximal repeats inside the string. 


\begin{DoxyParams}{\-Parameters}
{\em results} & \-The results of an iteration over a set of strings. \\
\hline
{\em state} & \-Internal state of the iterator that performed the search. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-Bit vectors with starts of \-Maximal repeats marked. 
\end{DoxyReturn}
\begin{DoxyAuthor}{\-Author}
\-Lassi \-Vapaakallio, \-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000039}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\-References iterator\-\_\-state\-::bwts, wavelet\-\_\-tree\-::get\-\_\-num\-\_\-bits, init\-\_\-bit\-\_\-vector(), and bit\-\_\-vector\-::mark\-\_\-bit.



\-Referenced by print\-\_\-maximal\-\_\-repeat\-\_\-substrings().

\hypertarget{maximal__repeats_8c_a4da412d937a20364aa1a90bc974d287f}{\index{maximal\-\_\-repeats.\-c@{maximal\-\_\-repeats.\-c}!print\-\_\-maximal\-\_\-repeat\-\_\-substrings@{print\-\_\-maximal\-\_\-repeat\-\_\-substrings}}
\index{print\-\_\-maximal\-\_\-repeat\-\_\-substrings@{print\-\_\-maximal\-\_\-repeat\-\_\-substrings}!maximal_repeats.c@{maximal\-\_\-repeats.\-c}}
\subsubsection[{print\-\_\-maximal\-\_\-repeat\-\_\-substrings}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf print\-\_\-maximal\-\_\-repeat\-\_\-substrings} (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{string, }
\item[{{\bf max\-\_\-repeat\-\_\-results} $\ast$}]{results, }
\item[{struct {\bf iterator\-\_\-state} $\ast$}]{state}
\end{DoxyParamCaption}
)}}\label{maximal__repeats_8c_a4da412d937a20364aa1a90bc974d287f}


\-Prints the substring the interval represents. 

\-First uses the mapper-\/function {\ttfamily \hyperlink{mapper_8c_af64bb40830b3d417933e2c2463f34739}{map\-\_\-maximal\-\_\-repeats\-\_\-to\-\_\-string()}} and then prints the substring based on the mapped index to stdout.


\begin{DoxyParams}{\-Parameters}
{\em string} & \-The original c-\/string. \\
\hline
{\em results} & \-Results of iterating over the c-\/string to find maximal repeats. \\
\hline
{\em state} & \-The internal state of the iterator performing the search. \\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{\-Author}
\-Lassi \-Vapaakallio, \-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000038}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\-References iterator\-\_\-state\-::bwts, map\-\_\-maximal\-\_\-repeats\-\_\-to\-\_\-string(), and max\-\_\-repeat\-\_\-make\-\_\-bit\-\_\-vector().

\hypertarget{maximal__repeats_8c_ae885f154f5e25d7008341027edebe4ec}{\index{maximal\-\_\-repeats.\-c@{maximal\-\_\-repeats.\-c}!search\-\_\-maximal\-\_\-repeats@{search\-\_\-maximal\-\_\-repeats}}
\index{search\-\_\-maximal\-\_\-repeats@{search\-\_\-maximal\-\_\-repeats}!maximal_repeats.c@{maximal\-\_\-repeats.\-c}}
\subsubsection[{search\-\_\-maximal\-\_\-repeats}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf search\-\_\-maximal\-\_\-repeats} (
\begin{DoxyParamCaption}
\item[{struct {\bf iterator\-\_\-state} $\ast$}]{state, }
\item[{void $\ast$}]{results}
\end{DoxyParamCaption}
)}}\label{maximal__repeats_8c_ae885f154f5e25d7008341027edebe4ec}


\-The function given as callback to iterate for finding maximal repeats. 

\-Determines if a node is a maximal repeat and adds it to a list.


\begin{DoxyParams}{\-Parameters}
{\em state} & \-The internal state of the iterator. \\
\hline
{\em results} & \-A pointer to a region of memory where previous results for this function can be found. \-Can safely be cast to {\ttfamily \hyperlink{maximal__repeats_8h_structmax__repeat__results}{max\-\_\-repeat\-\_\-results}} if iterate was initialized using {\ttfamily \hyperlink{maximal__repeats_8c_adfa4a6bccb21aa65557c85d4f208d50e}{initialize\-\_\-for\-\_\-max\-\_\-repeats()}}. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{maximal__repeats_8h_a16af217ecd83eaca3877fe491efb7392}{initialize\-\_\-for\-\_\-max\-\_\-repeats} 
\end{DoxySeeAlso}
\begin{DoxyAuthor}{\-Author}
\-Lassi \-Vapaakallio, \-Max \-Sandberg (\-R\-E\-Xiator) 
\end{DoxyAuthor}
\begin{DoxyRefDesc}{\-Bug}
\item[\hyperlink{bug__bug000037}{\-Bug}]\-No known bugs. \end{DoxyRefDesc}


\-References iterator\-\_\-state\-::current, is\-\_\-interval\-\_\-left\-\_\-maximal(), iterator\-\_\-state\-::runs\-\_\-vectors, and iterator\-\_\-state\-::threshold.



\-Referenced by initialize\-\_\-for\-\_\-max\-\_\-repeats().

